---
title: "Creation of sampling location master lists"
author: "C. Mimeault"
date: "June 13, 2021"
output: pdf_document
---

```{r setup, include=FALSE}
# this code requires R version 4.1
remove(list=ls())
knitr::opts_chunk$set(echo = TRUE)

# the following line enables . => until enabled by default in R 4.2
Sys.setenv("_R_USE_PIPEBIND_" = "true") 
```

```{r libraries, include=FALSE}
library(tidyverse)
library(here)
library(janitor)
library(formattable)
library(stringdist)
library(knitr)
library(parzer)
```

This document complements the document in which data extracted from juvenile wild salmon sea lice monitoring in British Columbia (BC) reports (that can be found [here](https://mowi.com/caw/sustainability/wild-salmonid-lice-monitoring/)) were extracted from PDF to .csv format. 

There are three main regions:

* Broughton Archipelago
* Discovery Islands
* Quatsino

# Standardization of sampling locations

## Broughton Archipelago

```{r BA data, include=FALSE}
# read file and correct site names according to the masterlist
BA_data <- read_csv(here("data/interim/broughton_archipelago/broughton_archipelago_all_data.csv")) |>
  clean_names() |>
  mutate(site_name = replace(site_name, site_name == "Denham Is", "Denham Island"),
         site_name = replace(site_name, site_name == "Doctor Island Fish \nFarm", "Doctor Island Fish Farm"),
         site_name = replace(site_name, site_name == "Doctor Island FF", "Doctor Island Fish Farm"),
         site_name = replace(site_name, site_name == "Glacier Falls FF", "Glacier Falls Fish Farm"),
         site_name = replace(site_name, site_name == "Glacier Falls Fish \nFarm", "Glacier Falls Fish Farm"),
         site_name = replace(site_name, site_name == "Hanson", "Hanson Island"),
         site_name = replace(site_name, site_name == "Humphrey Rock \nFish Farm", "Humphrey Rock"),
         site_name = replace(site_name, site_name == "Kwatsi Bay", "Kwatsi Point"),
         site_name = replace(site_name, site_name == "Matsui Bay", "Matsiu Bay"),   
         site_name = replace(site_name, site_name == "Midsummer Island Fish \nFarm", "Midsummer Island Fish Farm (Potts Bay)"), 
         site_name = replace(site_name, site_name == "Midsummer Island \nFish Farm", "Midsummer Island Fish Farm (Potts Bay)"),  
         site_name = replace(site_name, site_name == "Penphase Pass", "Penphrase Passage"),
         site_name = replace(site_name, site_name == "Penphrase Pass", "Penphrase Passage"),
         site_name = replace(site_name, site_name == "Sargeaunt Pass", "Sargeaunt Pass Fish Farm"),
         site_name = replace(site_name, site_name == "Sargeaunt Pass \nFish Farm", "Sargeaunt Pass Fish Farm"),
         site_name = replace(site_name, site_name == "Wakeman 5", "Wakeman 3"),
         site_name = replace(site_name, site_name == "Wehlis Bay FF", "Wehlis Bay Fish Farm"),
         site_name = replace(site_name, site_name == "Wehlis Bay Fish \nFarm", "Wehlis Bay Fish Farm")
         )
```

```{r BA data include all site names, include=FALSE}
# replace the "Site 01" with "1" in the site number column

BA_data <- BA_data |>
  mutate(site_number = replace(site_number, site_number == "Site 1", "1"),
         site_number = replace(site_number, site_number == "Site 2", "2"),
         site_number = replace(site_number, site_number == "Site 3", "3"),
         site_number = replace(site_number, site_number == "Site 4", "4"),
         site_number = replace(site_number, site_number == "Site 04", "4"),
         site_number = replace(site_number, site_number == "Site 5", "5"),
         site_number = replace(site_number, site_number == "Site 05", "5"),
         site_number = replace(site_number, site_number == "Site 06", "6"),
         site_number = replace(site_number, site_number == "Site 7", "7"),
         site_number = replace(site_number, site_number == "Site 07", "7"),
         site_number = replace(site_number, site_number == "Site 8", "8"),
         site_number = replace(site_number, site_number == "Site 08", "8"),
         site_number = replace(site_number, site_number == "Site 9", "9"),
         site_number = replace(site_number, site_number == "Site 09", "9"),
         site_number = replace(site_number, site_number == "Site 10", "10"),
         site_number = replace(site_number, site_number == "Site 11", "11"),
         site_number = replace(site_number, site_number == "Site 12", "12"),
         site_number = replace(site_number, site_number == "Site 13", "13"),
         site_number = replace(site_number, site_number == "Site 14", "14"),
         site_number = replace(site_number, site_number == "Site 15", "15"),
         site_number = replace(site_number, site_number == "Site 16", "16"),
         site_number = replace(site_number, site_number == "Site 17", "17"),
         site_number = replace(site_number, site_number == "Site 18", "18"),
         site_number = replace(site_number, site_number == "Site 19", "19"),
         site_number = replace(site_number, site_number == "Site 20", "20"),
         site_number = replace(site_number, site_number == "Site 21", "21"),
         site_number = replace(site_number, site_number == "Site 22", "22"),
         site_number = replace(site_number, site_number == "Site A", "A"),
         site_number = replace(site_number, site_number == "Site B", "B"),
         site_number = replace(site_number, site_number == "Site C", "C"),
         site_number = replace(site_number, site_number == "Site D", "D"),
         site_number = replace(site_number, site_number == "Site E", "E"),
         site_number = replace(site_number, site_number == "Site F", "F"),
         site_number = replace(site_number, site_number == "Site G", "G"),
         site_number = replace(site_number, site_number == "Site H", "H"),
         site_number = replace(site_number, site_number == "Site I", "I"),
         site_number = replace(site_number, site_number == "Site J", "J")
         )
```

```

```{r BA locations, include=FALSE}
locations_BA_2016 <- read_csv(here("data/interim/broughton_archipelago/all_broughton_archipelago_locations_2016.csv")) |> 
  clean_names()

locations_BA_2017 <- read_csv(here("data/interim/broughton_archipelago/all_broughton_archipelago_locations_2017.csv")) |> 
  clean_names()

locations_BA_2018 <- read_csv(here("data/interim/broughton_archipelago/all_broughton_archipelago_locations_2018.csv")) |> 
  clean_names()

locations_BA_2019 <- read_csv(here("data/interim/broughton_archipelago/all_broughton_archipelago_locations_2019.csv")) |> 
  clean_names()

locations_BA_2020 <- read_csv(here("data/interim/broughton_archipelago/all_broughton_archipelago_locations_2020.csv")) |> 
  clean_names()

BA_locations <- bind_rows(locations_BA_2016, locations_BA_2017, locations_BA_2018, locations_BA_2019, locations_BA_2020)
```

```{r BA locations master list lat long, include=FALSE}
# the GPS coordinates are in an incomplete (missing negative sign in longitudes) degrees and decimal minutes (DD:MM.MM) format
# provided as character strings
# converting the provided latitudes and longitudes to the decimal degrees (DD.DD) format with the parzer package
BA_locations <- BA_locations |>
  mutate(
    lat_decimal_degrees = parse_lat(latitude),
    long_decimal_degrees = parse_lon(paste(longitude, "W"))
  )
```

```{r BA locations master list names, include=FALSE}
# re-conciliating similar names and different GPS coordinates collected at the same location
# note that the coordinates for Sambo Point refer to a location on land which seems to be an error
# no fish sampled or collected at Sambo Point so leaving it in without correction
# GPS location of Wakeman 5 in 2019 is not on the map which only locates Wakeman 3 and 4
# Wakeman 5 was assumed to be the same as Wakeman 3
BA_locations <- BA_locations |>
  mutate(site_name = replace(site_name, site_name == "Alder Point", "Alder Bay"),
         site_name = replace(site_name, site_name == "Hanson", "Hanson Island"),
         site_name = replace(site_name, site_name == "Humphrey Rock Fish Farm", "Humphrey Rock"),
         site_name = replace(site_name, site_name == "Kwatsi Bay", "Kwatsi Point"),         
         site_name = replace(site_name, site_name == "Mount Frederick", "Mount Frederick Bay"),
         site_name = replace(site_name, site_name == "Sargeaunt Pass", "Sargeaunt Pass Fish Farm"),
         site_name = replace(site_name, site_name == "Penphrase Pass", "Penphrase Passage"),
         site_name = replace(site_name, site_name == "Wakeman 5", "Wakeman 3"),
         site_name = replace(site_name, site_name == "Wicklow Bay", "Wicklow Point")
         ) |>
  distinct()
```

```{r BA locations master list unique records, include=FALSE}
# new locations added in 2019 and 2020 reports
# re-conciliating GPS coordinates collected at the same location 
# error in Hoeya South GPS coordinates in 2019 report - using GPS coordinates from 2020 report
# helpful website to locate several sites: https://www.mapcustomizer.com/
# GPS coordinates for Millar Point were approximately 500m apart - assumed to be the same location

BA_clean_locations <- BA_locations |>
  filter(
    (site_name == "Alder Bay" & site_number == "I") |
    (site_name == "Arthur Point" & site_number == "21") |
    (site_name == "Baker Island" & site_number == "19") |
    (site_name == "Batt Bluff West") |
    (site_name == "Bennett Point Fish Farm (Noo-La)") |
    (site_name == "Brent Bay" & site_number == "6") |
    (site_name == "Chop Bay" & site_number == "3") |
    (site_name == "Codrington Point" & site_number == "G") |
    (site_name == "Denham Island" & site_number == "18") |
    (site_name == "Doctor Island Fish Farm" & site_number == "5") |
    (site_name == "Freshwater Bay") |
    (site_name == "Glacier Falls Fish Farm" & site_number == "16") |
    (site_name == "Gwayasdums 1") |
    (site_name == "Hanson Island") |
    (site_name == "Harry Bay" & site_number == "D") |
    (site_name == "Hoeya Sound") | 
    (site_name == "Hoeya South" & longitude == "125 58.870") |
    (site_name == "Humphrey Rock" & site_number == "10") |
    (site_name == "Jumper Island" & site_number == "20") |
    (site_name == "Kokish Estuary") |
    (site_name == "Kwatsi Point" & site_number == "15") |
    (site_name == "Lady Island" & site_number == "4") |
    (site_name == "Lance Bay" & site_number == "8") |
    (site_name == "Larsen Island Fish Farm") |
    (site_name == "London Point" & site_number == "13") |
    (site_name == "Matsiu Bay") |
    (site_name == "McKenzie Cove") |
    (site_name == "Midsummer Island Fish Farm (Potts Bay)" & site_number == "2") |
    (site_name == "Miller Point" & site_number == "14") |
    (site_name == "Mount Frederick Bay") |
    (site_name == "Nimpkish Estuary") |
    (site_name == "Oline Point" & site_number == "12") |
    (site_name == "Penphrase Passage" & site_number == "C") |
    (site_name == "Phillip Point West" & site_number == "E") |
    (site_name == "Poppelwell Point" & site_number == "J") |
    (site_name == "Pumish Point" & site_number == "11") |
    (site_name == "Sambo Point") |
    (site_name == "Sargeaunt Pass Fish Farm" & site_number == "9") |
    (site_name == "Shelterless Bay" & site_number == "7") |
    (site_name == "Sutlej North" & site_number == "F") |
    (site_name == "Swanson Island Fish Farm" & site_number == "1") |
    (site_name == "Tomakstum Island") |
    (site_name == "Viner Sound" & site_number == "17") |
    (site_name == "Wakeman" & site_number == "") |
    (site_name == "Wakeman 3" & longitude == "126 30.926") |
    (site_name == "Wakeman 4" & longitude == "126 29.316") |
    (site_name == "Wehlis Bay Fish Farm" & site_number == "H") |
    (site_name == "Wicklow Point" & site_number == "22")
      ) |>
  select(site_number, site_name, lat_decimal_degrees, long_decimal_degrees)
```

```{r BA locations master list numbers, include=FALSE}
# 12 sites do not have site numbers
# adding them for completeness
# starting from 1000 for the sites in BA
BA_clean_locations <- BA_clean_locations |>
  mutate(
    site_number = if_else(site_name == "Batt Bluff West", "1000", site_number),
    site_number = if_else(site_name == "Freshwater Bay", "1001", site_number),
    site_number = if_else(site_name == "Gwayasdums 1", "1002", site_number),
    site_number = if_else(site_name == "Hanson Island", "1003", site_number),
    site_number = if_else(site_name == "Hoeya Sound", "1004", site_number),
    site_number = if_else(site_name == "Kokish Estuary", "1005", site_number),
    site_number = if_else(site_name == "Larsen Island Fish Farm", "1006", site_number),
    site_number = if_else(site_name == "Matsiu Bay", "1007", site_number),
    site_number = if_else(site_name == "Hanson Island", "1008", site_number),
    site_number = if_else(site_name == "McKenzie Cove", "1009", site_number),
    site_number = if_else(site_name == "Mount Frederick Bay", "1010", site_number),
    site_number = if_else(site_name == "Nimpkish Estuary", "1011", site_number),
    site_number = if_else(site_name == "Tomakstum Island", "1012", site_number),
    site_number = if_else(site_name == "Hoeya South", "1013", site_number),
    site_number = if_else(site_name == "Wakeman 3", "1014", site_number),
    site_number = if_else(site_name == "Wakeman 4", "1015", site_number)
    ) 
```

```{r BA locations master finale, include=FALSE}
BAA_sites <- BA_clean_locations |>
  mutate(
    site_number = as_factor(site_number),
    area = "Broughton Archipelago"
  )
```

```{r save BA locations master finale, include=FALSE}
write_csv(BAA_sites, here("data/interim/broughton_archipelago/BAA_sites.csv"))
```